<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring Harga Emas (1 Gram)</title>
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    
    <!-- Load Montserrat Font -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* Konfigurasi untuk font Montserrat */
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f4f7f9;
        }
        /* Custom colors based on user request */
        /* Galeri 24 Theme */
        .color-g24-bg { background-color: #F5EDCC; }
        .color-g24-text { color: #8B8159; } 
        .color-g24-dark { color: #A69C75; }

        /* Antam Theme */
        .color-antam-bg { background-color: #F0FDFB; } 
        .color-antam-dark { color: #00726B; } 
        .color-antam-medium { color: #009688; } 

        /* Responsive design for the chart container */
        .chart-container {
            position: relative;
            height: 55vh; 
            width: 100%;
        }
        /* Mengurangi ketebalan font default */
        .font-extrabold { font-weight: 700; } 
        .font-bold { font-weight: 600; }
        
        /* Gaya kustom untuk radio button yang modern */
        .radio-group input[type="radio"] {
            display: none;
        }
        .radio-group label {
            padding: 8px 16px;
            cursor: pointer;
            border-radius: 9999px; /* Full rounded */
            transition: all 0.2s;
            font-weight: 500;
            color: #6B7280;
            border: 1px solid #D1D5DB;
            background-color: #FFFFFF;
            /* Tambahkan hover state untuk interaksi */
            &:hover {
                background-color: #F3F4F6;
            }
        }
        .radio-group input[type="radio"]:checked + label {
            background-color: #00726B; /* Antam color for selected state */
            color: #FFFFFF;
            border-color: #00726B;
            box-shadow: 0 4px 6px -1px rgba(0, 114, 107, 0.1), 0 2px 4px -2px rgba(0, 114, 107, 0.1);
        }
    </style>
</head>
<body>
    <div class="max-w-5xl mx-auto p-4 sm:p-8 bg-white shadow-2xl rounded-3xl mt-10 mb-10 border-t-4 border-yellow-500">
        <!-- HEADER -->
        <header class="text-center mb-10">
            <h1 class="text-xl sm:text-3xl font-bold text-gray-800 tracking-tight mb-2">
                Monitoring Harga Emas
            </h1>
            <!-- Mengganti sintaks Jinja dengan ID untuk diisi oleh JS -->
            <p class="text-md sm:text-sm color-antam-medium font-small">
                Data Harian Emas 1 Gram - Diperbarui <span id="latestTanggal"></span> pukul <span id="latestJam"></span> (WIB)
            </p>
        </header>
        
        <!-- BAGIAN HARGA TERBARU (Cards) -->
        <div class="mb-12">
            <h2 class="text-xl sm:text-xl font-bold text-gray-700 mb-6 border-b pb-2">Harga Jual & Buyback Hari Ini</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                
                <!-- Card GALERI 24 -->
                <div class="color-g24-bg border border-gray-300 p-6 rounded-2xl shadow-lg transition duration-300 hover:shadow-xl hover:scale-[1.01]">
                    <h3 class="text-xl font-bold color-g24-text mb-4 flex items-center">
                        <!-- Icon Placeholder: Gold Bar SVG -->
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="#A69C75" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        GALERI 24
                    </h3>
                    
                    <div class="flex justify-between items-center mb-2">
                        <p class="text-sm font-medium text-gray-600">Harga Jual:</p>
                        <!-- Mengganti sintaks Jinja dengan ID untuk diisi oleh JS -->
                        <p id="g24_jual_price" class="text-2xl font-bold color-g24-text">Rp -</p>
                    </div>

                    <div class="flex justify-between items-center pt-2 border-t border-gray-400">
                        <p class="text-sm font-medium text-gray-600">Harga Buyback:</p>
                        <!-- Mengganti sintaks Jinja dengan ID untuk diisi oleh JS -->
                        <p id="g24_buyback_price" class="text-xl font-bold color-g24-dark">Rp -</p>
                    </div>
                </div>

                <!-- Card ANTAM -->
                <div class="border border-gray-300 p-6 rounded-2xl shadow-lg transition duration-300 hover:shadow-xl hover:scale-[1.01] color-antam-bg">
                    <h3 class="text-xl font-bold color-antam-dark mb-4 flex items-center">
                        <!-- Icon Placeholder: Coin SVG -->
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="#00726B" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V6m-6 6h2m-2 0a2 2 0 100 4m0 4v2m0-6V6m6 10H6m-2 0a2 2 0 110 4m0 4v2m-2-6h2m6-4a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V6m6 6h2m-2 0a2 2 0 100 4m0 4v2m0-6V6m6 6h2m-2 0a2 2 0 110 4m0 4v2m0-6V6"></path></svg>
                        ANTAM
                    </h3>
                    
                    <div class="flex justify-between items-center mb-2">
                        <p class="text-sm font-medium text-gray-600">Harga Jual:</p>
                        <!-- Mengganti sintaks Jinja dengan ID untuk diisi oleh JS -->
                        <p id="antam_jual_price" class="text-2xl font-bold color-antam-dark">Rp -</p>
                    </div>

                    <div class="flex justify-between items-center pt-2 border-t border-gray-400">
                        <p class="text-sm font-medium text-gray-600">Harga Buyback:</p>
                        <!-- Mengganti sintaks Jinja dengan ID untuk diisi oleh JS -->
                        <p id="antam_buyback_price" class="text-xl font-bold color-antam-medium">Rp -</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- BAGIAN GRAFIK HARGA -->
        <div class="mb-8 p-6 border border-gray-200 rounded-2xl shadow-xl bg-gray-50">
            <h2 class="text-xl sm:text-xl font-bold text-gray-700 mb-4">Grafik Harga Historis</h2>
            
            <!-- Radio Button Group untuk memilih Jual/Buyback -->
            <!-- Mempertahankan onchange yang sudah benar -->
            <div class="radio-group flex gap-3 mb-6">
                <div>
                    <input type="radio" id="chart_jual" name="chart_type" value="jual" checked onchange="updateChart('jual')">
                    <label for="chart_jual">Harga Jual</label>
                </div>
                <div>
                    <input type="radio" id="chart_buyback" name="chart_type" value="buyback" onchange="updateChart('buyback')">
                    <label for="chart_buyback">Harga Buyback</label>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="priceChart"></canvas>
            </div>
            <p class="text-xs text-gray-500 mt-4 text-center">Data diambil dari entri harga terbaru setiap tanggal. Grafik menunjukkan 1 titik per hari.</p>
        </div>
        
        <footer class="text-center text-sm text-gray-500 pt-6 border-t mt-6">
            <p>Aplikasi Monitoring Harga Emas (Simulasi Data)</p>
        </footer>

    </div>

    <script>
        // =======================================================
        // MOCK DATA (Data Simulasi)
        // Dibuat untuk menggantikan data dari Flask/Jinja
        // =======================================================

        const latest = {
            Tanggal: "04 November 2025",
            Jam: "08:53",
            GALERI24_Jual: 1395000,
            GALERI24_Buyback: 1280000,
            ANTAM_Jual: 1400000,
            ANTAM_Buyback: 1290000
        };

        const dates = ["29 Okt", "30 Okt", "31 Okt", "01 Nov", "02 Nov", "03 Nov", "04 Nov"];
        
        // Data Harga Jual
        const g24_jual = [1385000, 1380000, 1390000, 1405000, 1395000, 1390000, 1395000];
        const antam_jual = [1390000, 1385000, 1395000, 1410000, 1400000, 1395000, 1400000];
        
        // Data Harga Buyback
        const g24_buyback = [1270000, 1265000, 1275000, 1290000, 1280000, 1275000, 1280000];
        const antam_buyback = [1280000, 1275000, 1285000, 1300000, 1290000, 1285000, 1290000];


        // =======================================================
        // HELPER FUNCTION
        // =======================================================
        
        // Fungsi untuk memformat angka menjadi format Rupiah (IDR)
        function formatRupiah(angka) {
            const number = parseFloat(angka);
            return "Rp " + number.toLocaleString('id-ID', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            });
        }
        
        // Fungsi untuk merender harga terbaru ke dalam kartu (menggantikan Jinja di HTML)
        function renderLatestPrices() {
            document.getElementById('latestTanggal').textContent = latest.Tanggal;
            document.getElementById('latestJam').textContent = latest.Jam;

            document.getElementById('g24_jual_price').textContent = formatRupiah(latest.GALERI24_Jual);
            document.getElementById('g24_buyback_price').textContent = formatRupiah(latest.GALERI24_Buyback);
            
            document.getElementById('antam_jual_price').textContent = formatRupiah(latest.ANTAM_Jual);
            document.getElementById('antam_buyback_price').textContent = formatRupiah(latest.ANTAM_Buyback);
        }

        // =======================================================
        // CHART LOGIC (Didasarkan pada skrip Anda)
        // =======================================================

        var priceChartInstance = null; // Variabel untuk menyimpan instance chart

        // Fungsi untuk menginisialisasi atau memperbarui chart
        function updateChart(chartType) {
            
            const isJual = chartType === 'jual';
            
            // Pilih dataset berdasarkan chartType
            const dataG24 = isJual ? g24_jual : g24_buyback;
            const dataAntam = isJual ? antam_jual : antam_buyback;
            
            const labelG24 = isJual ? 'Galeri 24 (Jual)' : 'Galeri 24 (Buyback)';
            const labelAntam = isJual ? 'ANTAM (Jual)' : 'ANTAM (Buyback)';
            
            const titleText = isJual ? 
                'Perbandingan Harga Jual Emas Historis' : 
                'Perbandingan Harga Buyback Emas Historis';
            
            const datasets = [{
                label: labelG24,
                data: dataG24,
                // Warna tema Galeri 24 (darker)
                borderColor: '#A69C75', 
                backgroundColor: 'rgba(166, 156, 117, 0.1)', // Fill area
                tension: 0.4, // Line smooth
                borderWidth: 2,
                pointRadius: 4,
                pointBackgroundColor: '#A69C75',
                fill: true,
            },
            {
                label: labelAntam,
                data: dataAntam,
                // Warna tema Antam
                borderColor: '#00726B', 
                backgroundColor: 'rgba(0, 114, 107, 0.1)', // Fill area
                tension: 0.4,
                borderWidth: 2,
                pointRadius: 4,
                pointBackgroundColor: '#00726B',
                fill: true,
            }];

            const config = {
                // Mengubah tipe chart menjadi line
                type: 'line', 
                data: {
                    labels: dates, 
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false, 
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: 'Tanggal',
                                font: {
                                    size: 12, 
                                    family: 'Montserrat',
                                    weight: '500' 
                                }
                            },
                            ticks: {
                                font: {
                                    size: 10,
                                    family: 'Montserrat'
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Harga (Rp)',
                                font: {
                                    size: 12,
                                    family: 'Montserrat',
                                    weight: '500'
                                }
                            },
                            beginAtZero: false,
                            ticks: {
                                callback: function(value, index, ticks) {
                                    // PERUBAHAN DI SINI: Menggunakan format Rupiah penuh, menghapus penyingkatan "jt" atau "rb"
                                    return formatRupiah(value);
                                },
                                font: {
                                    size: 10,
                                    family: 'Montserrat'
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                boxWidth: 10, 
                                font: {
                                    size: 12, 
                                    family: 'Montserrat',
                                    weight: '500'
                                }
                            }
                        },
                        title: {
                            display: true,
                            text: titleText,
                            font: {
                                size: 14, 
                                family: 'Montserrat',
                                weight: '600' // Diperkuat sedikit agar lebih jelas
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += formatRupiah(context.parsed.y);
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            };

            if (priceChartInstance) {
                // Jika instance sudah ada, update data
                priceChartInstance.data.datasets = datasets;
                priceChartInstance.options.plugins.title.text = titleText;
                priceChartInstance.update();
            } else {
                // Jika belum ada, inisialisasi
                const ctx = document.getElementById('priceChart').getContext('2d');
                priceChartInstance = new Chart(ctx, config);
            }
        }
        
        // Fungsi inisialisasi utama
        function initChart() {
            // Periksa apakah data ada sebelum inisialisasi chart
            if (!dates || dates.length === 0) {
                console.log("Data grafik kosong, Chart.js tidak diinisialisasi.");
                return;
            }
            
            // Inisialisasi dengan Harga Jual (default)
            updateChart('jual');
            
            // Render harga terbaru
            renderLatestPrices();
        }


        // Panggil inisialisasi chart saat dokumen dimuat
        window.onload = function() {
            initChart();
        };
    </script>
</body>
</html>
